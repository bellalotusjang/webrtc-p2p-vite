
🚀 WebRTC P2P 화상 채팅 구현 프로젝트
1. 프로젝트 소개
본 프로젝트는 WebRTC(Web Real-Time Communication) 기술을 활용하여 웹 브라우저 간에 서버를 거치지 않고 실시간으로 P2P(Peer-to-Peer) 통신을 구현한 화상 채팅 애플리케이션입니다. 클라이언트 간의 연결 협상(시그널링)에만 서버를 이용하며, 미디어 데이터는 직접 교환하여 서버 부하를 최소화하고 지연 시간을 단축합니다.

2. 🏗️ 아키텍처 및 주요 기술 스택
구분	기술 스택	설명
프론트엔드 (클라이언트)	React.js (Vite), HTML5 Media API, CSS	사용자 인터페이스 구성 및 로컬 미디어(카메라/마이크) 접근, WebRTC API 관리
백엔드 (시그널링 서버)	Node.js, Express, Socket.IO	클라이언트 간의 초기 연결 협상(SDP, ICE Candidate) 메시지 중개 역할
핵심 통신 기술	WebRTC (RTCPeerConnection, RTCDataChannel)	P2P 연결, 미디어 스트림 및 데이터 전송을 담당하는 핵심 기술


3. 🌟 구현 기능 목록
본 프로젝트를 통해 다음과 같은 주요 기능들을 구현했습니다.

실시간 음성 및 화상 채팅: 사용자 간의 P2P 연결을 통한 실시간 양방향 미디어 스트리밍.

화면 공유: 사용자의 전체 화면 또는 특정 애플리케이션 창을 실시간으로 캡처하여 스트림으로 공유하는 기능.

파일 전송: RTCDataChannel을 이용하여 P2P 채널을 통해 파일을 직접 전송 (서버를 거치지 않음).

채팅방 관리: Room ID 기반으로 사용자가 특정 방에 입장/퇴장할 수 있는 로직 구현.

자동 방 삭제 재설계: 마지막 사용자가 퇴장할 경우, 서버가 해당 방을 즉시 정리하여 Room ID를 재사용할 수 있도록 로직 개선.

4. 🛠️ 개발 환경 설정 및 실행 방법
프로젝트를 로컬 환경에서 실행하려면 최소 두 개의 터미널(CMD/PowerShell) 창이 필요합니다.

A. 의존성 설치
프로젝트 루트 폴더와 백엔드 서버 폴더에서 각각 의존성을 설치합니다.


# 프로젝트 루트 폴더 (webrtc-p2p-vite)
npm install

# 백엔드 서버 폴더 (server)로 이동
cd server
npm install
B. 서버 실행
총 세 개의 터미널(또는 VS Code 탭)이 필요합니다.

백엔드 시그널링 서버 실행 (포트 3001)

server 폴더에서 실행합니다.


npm start
프론트엔드 개발 서버 실행 (포트 5173)

프로젝트 루트 폴더(webrtc-p2p-vite)에서 실행합니다.


npm run dev
C. 외부 접속 시연 (Ngrok 사용)
WebRTC는 보안 연결(HTTPS)이 필수적이므로, 외부 테스트 시에는 반드시 Ngrok과 같은 터널링 도구를 사용해야 합니다.

Ngrok 실행 및 터널링

ngrok.exe가 있는 폴더로 이동 후, 백엔드 포트를 노출합니다.


ngrok http 3001
클라이언트 접속 주소: Ngrok이 제공하는 HTTPS 주소를 사용하여 접속합니다. (예: https://averse-estella-washed.ngrok-free.dev)

5. 💡 기술적 이슈 및 해결 과정
이슈 유형	직면한 문제	해결 방법
기술 난제	로컬 서버에 대한 외부 접속 및 HTTPS 미지원으로 WebRTC 기능이 작동하지 않음.	Ngrok을 사용하여 로컬 포트를 HTTPS 주소로 터널링하고, 프론트엔드 코드를 수정하여 Ngrok 주소를 시그널링 서버 URL로 대체함.
기능 버그	마지막 사용자가 퇴장해도 서버에서 방이 삭제되지 않아 Room ID 재사용이 불가능함.	서버의 Socket.IO 로직을 재설계하여, 유저 퇴장 이벤트 발생 시 해당 방의 잔여 인원을 즉시 확인하고 인원이 0명일 경우 방을 즉시 삭제하도록 이벤트 기반 처리로 보완함.

6. 🛠️ 향후 보완 계획
본 프로젝트를 상용 서비스로 확장하기 위해 다음과 같은 보완이 필요합니다.

NAT/방화벽 문제 해결: 연결 실패를 최소화하기 위해 STUN 서버를 기본 설정하고, 연결 불가능 시를 대비하여 **TURN 서버(미디어 릴레이)**를 구축할 계획입니다.

인증 및 보안 강화: 현재 누구나 방에 접근 가능하므로, JWT 기반 인증 시스템을 도입하여 방 접속에 대한 권한을 검증하고 보안을 강화할 예정입니다.

서버 확장성: 시그널링 서버의 부하 분산을 위해 클러스터링을 적용하여 확장성을 확보할 계획입니다.
